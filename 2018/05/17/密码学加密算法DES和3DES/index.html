<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>密码学密码学对称加密算法DES和3DES</title>
  <meta name="description" content="密码学">
  <meta name="author" content="黎跃春">

  <meta name="keywords" content="DES"
  />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="密码学密码学对称加密算法DES和3DES">
  <meta name="twitter:description" content="密码学">

  <meta property="og:type" content="article">
  <meta property="og:title" content="密码学密码学对称加密算法DES和3DES">
  <meta property="og:description" content="密码学">
  <meta property="og:site_name" content="DESe"
  />


  <link rel="icon" type="image/png" href="/images/favicon.png" />
  <link href="/images/favicon.png" rel="shortcut icon" type="image/png">


  <link rel="stylesheet" href=" /css/main.css ">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:4000/2018/05/17/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95DES%E5%92%8C3DES/">
  <link rel="alternate" type="application/rss+xml" title="刘蛟区块链博客" href="http://localhost:4000 /feed.xml
    ">

  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />

  <!-- 站点统计 -->
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <!-- <script>(function() {var _53code = document.createElement("script");_53code.src = "https://tb.53kf.com/code/code/10174862/1";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(_53code, s);})();</script> -->
  <!-- 百度统计 -->
  
  <script>
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?f3290601666dc2ca016a38c340c144f1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  

  <!-- google 统计 -->
  
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-104237177-1', 'auto');
    ga('send', 'pageview');
  </script>
  

  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>

</head>


<body>

  <span class="mobile btn-mobile-menu">        
      <div class="nav_container">
         <nav class="nav-menu-item" style = "float:right">
            <i class="nav-menu-item">
              <a href="/#blog" title="" class="blog-button">  博客主页
              </a>
            </i>
            
                <i class="nav-menu-item">

                  <a href="/archive" title="archive" class="btn-mobile-menu__icon">
                      所有文章
                  </a>
                </i>
            
                <i class="nav-menu-item">

                  <a href="/tags" title="tags" class="btn-mobile-menu__icon">
                      分类
                  </a>
                </i>
            
                <i class="nav-menu-item">

                  <a href="/about" title="about" class="btn-mobile-menu__icon">
                      关于我
                  </a>
                </i>
            
          </nav>
          
      </div>
    </span> <header class="panel-cover panel-cover--collapsed" style="background-image: url('/images/background-cover.jpg')">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">
        <!-- 头像效果-start -->
        <div class="ih-item circle effect right_to_left">
          <a href="/#blog" title="前往 刘蛟区块链博客 的主页" class="blog-button">
            <div class="img"><img src="/images/avatar.jpg" alt="img"></div>
            <div class="info">
              <div class="info-back">
                <h2 style="font-size: 14px">
                   微信:13611179034 
                </h2>´
                <p style="font-size: 6px">
                   孔壹学院|链乎 
                </p>
              </div>
            </div>
          </a>
        </div>
        <!-- 头像效果-end -->
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for 刘蛟区块链博客" class="blog-button">刘蛟区块链博客</a></h1>
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">初级区块链工程师</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" /> 


        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">博客主页</a></li>
                
                <li class="navigation__item"><a href="/archive" title="archive">所有文章</a></li>
                
                <li class="navigation__item"><a href="/tags" title="tags">分类</a></li>
                
                <li class="navigation__item"><a href="/about" title="about">关于我</a></li>
                
              </ul>
            </nav>
          </div>
        </div>

        <div style="display:flex;justify-content:center;-webkit-justify-content:center">
          <div style="display:flex;flex-direction:column;align-items:center;-webkit-flex-direction:column;-webkit-align-items:center;margin-right:10px">
            <img src="/images/zhishixingqiu.png" style="width:120px;height:120px;margin-top:30px;margin-bottom:10px" />
            <span class="panel-cover__subtitle panel-subtitle" style="font-size: 12px">扫一扫</span>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;-webkit-flex-direction:column;-webkit-align-items:center;margin-left:10px">
            <img src="/images/lianhu.jpg" style="width:120px;height:120px;margin-top:30px;margin-bottom:10px" />
            <span class="panel-cover__subtitle panel-subtitle" style="font-size: 12px">链乎公众号</span>
          </div>
        </div>

      </div>
    </div>
  </div>

  
  <div class="panel-cover--overlay cover-clear"></div>
  

  </div>
</header>


  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title">密码学密码学对称加密算法DES和3DES</h1>
    <div class="post-meta">
      <img src="/images/calendar.png" width="20px"/>
      <time datetime="2018-05-17 00:00:00 +0800" itemprop="datePublished" class="post-meta__date date">2018-05-17</time>

      <span id="busuanzi_container_page_pv"> | 阅读：<span id="busuanzi_value_page_pv"></span>次</span>
    </p>
    </div>
  </header>

  <section class="post">
    <h1 id="go密码学对称加密算法des和3des">go密码学对称加密算法DES和3DES</h1>

<ul>
  <li>
    <p>加密模式</p>

    <ul>
      <li><strong>ECB模式</strong> 全称Electronic Codebook模式，译为电子密码本模式(由于安全性差,已经被淘汰)</li>
      <li><strong>CBC模式</strong> 全称Cipher Block Chaining模式，译为密文分组链接模式(分组模式)</li>
      <li><strong>CFB模式</strong> 全称Cipher FeedBack模式，译为密文反馈模式(流模式)</li>
      <li><strong>OFB模式</strong> 全称Output Feedback模式，译为输出反馈模式。(流模式)</li>
      <li><strong>CTR模式</strong> 全称Counter模式，译为计数器模式。(流模式)</li>
    </ul>
  </li>
</ul>

<h2 id="des加密算法可解密可加密">DES加密算法(可解密可加密)</h2>
<p>DES是以64比特的明文为一个单位来进行加密的，超过64比特的数据，要求按固定的64比特的大小分组，分组有很多模式，后续单独总结，暂时先介绍DES加密算法。DES使用的密钥长度为64比特，但由于每隔7个比特设置一个奇偶校验位，因此其密钥长度实际为56比特。奇偶校验为最简单的错误检测码，即根据一组二进制代码中1的个数是奇数或偶数来检测错误。</p>

<hr />
<p>DES加密需要先将密码分组,然后把要加密的明文进行PKCS5Padding进行补码,既8位取余,余几位,补几位,解密后同样要把后面补的几位去掉,</p>

<hr />

<p><strong>go语言实现</strong></p>

<p><strong>加密</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>//DES对称性加密
//DES 有不同的加密模式(5种)本次采用CBC加密模式
func MyDesEncrypt(origData,key []byte)  {  //origData 明文
	//把钥匙传进来加密 换成block块
	block,_:=des.NewCipher(key) //密钥分组
	//将明文按密钥长度做补码运算
	origData=PKCS5Padding(origData,block.BlockSize())
	//设置加密方式
	blockMode :=cipher.NewCBCEncrypter(block,key) //CBC加密方式
	//创建明文长度的字节数组
	crypted:=make([]byte,len(origData))
	//加密明文
	blockMode.CryptBlocks(crypted,origData)
	//将字节数组转换成字符串 转成base64 类型
	fmt.Printf(base64.StdEncoding.EncodeToString(crypted))

}
</code></pre>
</div>
<p><strong>补码</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>//实现去除补码
func PKCS5Unpandding(origData []byte) []byte {
	length:=len(origData) //计算长度
	unpadding:=int(origData[length-1])//把最后一个值拿出来
	return origData[:(length-unpadding)]

}
</code></pre>
</div>

<p><strong>解密</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>//DES解密方法
func MyDESDecrypt(data string,key []byte)  {
	//将字符串转换成字节数组[]byte
	crypted, _ := base64.StdEncoding.DecodeString(data)//将字符串转成[]byte数组
	//fmt.Println(crypted)
	block,_:=des.NewCipher(key)//将字节密钥转换成block块 ,密钥分组
	//设置解密方式
	blockMode:=cipher.NewCBCDecrypter(block,key)
	//创建密文大小的[]byte切片
	origData:=make([]byte,len(crypted))
	//解密密文到数组origData中
	blockMode.CryptBlocks(origData,crypted)
	//除去补码
	origData=PKCS5Unpandding(origData)
	//打印明文
	fmt.Println(string(origData))

}
</code></pre>
</div>

<p><strong>去码</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>func PKCS5Padding(ciphertext []byte,blockSize int)  []byte{ //实现明文的补码
	padding:=blockSize-len(ciphertext)%blockSize //查看需要补几位 比如差3位
	padtext:=bytes.Repeat([]byte{byte(padding)},padding)//重复几位将里面的 这里就补333
	return append(ciphertext,padtext...)  //append[]byte 后面需要加...
}
</code></pre>
</div>

<p><strong>方法调用</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>func main()  {
//声明密钥 利用此密钥 实现明文的加密和密文的解密
key:=[]byte("12345678") //长度为8
	//加密
	MyDesEncrypt([]byte("hello kong yia"),key)
	//解密
	MyDESDecrypt("6xl7sC7Om9o+lQ1S2j1U6g==",key)

}
</code></pre>
</div>

<p><strong>输出结果</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>6xl7sC7Om9o+lQ1S2j1U6g==hello kong yia
</code></pre>
</div>

<h2 id="3des-加密及解密">3DES 加密及解密</h2>
<p>DES的升级版,24字节的密钥分为,分为3组分别进行加密,以提高安全性</p>

<h3 id="加密">加密</h3>

<p>对比DES，发现只是换了NewTripleDESCipher。不过，需要注意的是，密钥长度必须24byte，否则直接返回错误。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
//补码
func PKCS5padding(ciphertext []byte,blocksize int)[]byte  {
	padding:=blocksize-len(ciphertext)%blocksize  //%24
	padtext:=bytes.Repeat([]byte{byte(padding)},padding) //补齐
	return append(ciphertext,padtext...)  //合并

}
//去码
func PKCS5Unpadding(origData []byte)[]byte  {
	length:=len(origData)  //测密码长度
	unadding:=int(origData[length-1]) //取最后一位
	return origData[:(length-unadding)]  //减去最后一位的位数

}
//3DES 加密
func TripleDesEncrypt(origData []byte,key []byte)[] byte  {
	//3DES密钥长度必须是24位
	block,_:=des.NewTripleDESCipher(key)  //获得密钥块  Triple-&gt;3的意思
	//补码
	origData=PKCS5padding(origData,block.BlockSize())
	//设置加密模式
	blockMode:=cipher.NewCBCEncrypter(block,key[:8]) //固定8
	//创建密文数组,加密
	crypted :=make([]byte,len(origData))
	blockMode.CryptBlocks(crypted,origData)
	return crypted
}
//解密
func TripDesDecrypt(crypted,key[]byte)[]byte  {
		block,_:=des.NewTripleDESCipher(key)  //通过密钥得到密码块
		blockMode:=cipher.NewCBCDecrypter(block,key[:8])  //解密
		origData:=make([]byte,len(crypted))  //创建数组
		blockMode.CryptBlocks(origData,crypted) // 解密
		origData=PKCS5Unpadding(origData)  //去码
		return origData

}
//CBC模式
</code></pre>
</div>

<p><strong>方法调用</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>func main()  {
	var key = []byte("123456789012345678901234") //长度为24byte
var encryptcode=TripleDesEncrypt([]byte("liujiaow"),key)
var decryptcode=TripDesDecrypt(encryptcode,key)
fmt.Println(base64.StdEncoding.EncodeToString(encryptcode))
fmt.Println(string(decryptcode))
}

</code></pre>
</div>

<p><strong>输出结果</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>vtTkkOTHUHx2nY5Pu2ObTQ==
liujiaow

</code></pre>
</div>


  </section>
</article>


<section class="post-comments">
  <!--PC和WAP自适应版-->
<div id="SOHUCS" sid=密码学密码学对称加密算法DES和3DES ></div>
<script type="text/javascript">
(function(){
var appid = 'cytfSz8yx';
var conf = 'prod_ad710bf09d342725ed536beddc68aa27';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("http://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
</section>

 <section class="footer">
  <footer>
    <div class="footer_div">
      <nav class="cover-navigation navigation--social">
        <ul class="navigation">

          
          <!-- Weibo -->
          <li class="navigation__item_social">
            <a href="http://weibo.com/mobiledevelopment" title="@mobiledevelopment 的微博" target="_blank">
              <i class='social fa fa-weibo fa-2x'></i>
              <span class="label">Weibo</span>
            </a>
          </li>
           
          <!-- Github -->
          <li class="navigation__item_social">
            <a href="https://github.com/liyuechun" title="@liyuechun 的 Github" target="_blank">
              <i class='social fa fa-github fa-2x'></i>
              <span class="label">Github</span>
            </a>
          </li>
            

          <!-- RSS -->
          <li class="navigation__item_social">
            <a href="/feed.xml" rel="author" title="RSS" target="_blank">
              <i class='social fa fa-rss fa-2x'></i>
              <span class="label">RSS</span>
            </a>
          </li>

          
          <!-- Email -->
          <li class="navigation__item_social">
            <a href="mailto:836921287@qq.com" title="Contact me">
              <i class='social fa fa-envelope fa-2x'></i>
              <span class="label">Email</span>
            </a>
          </li>
          

        </ul>
      </nav>

    </div>

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
      <thead>
        <tr id="bar_head">
          <th colspan="11">友情链接</th>
        </tr>
      </thead>

      <tr align="center" valign="middle">
          <td><a href="http://www.kongyixueyuan.com">区块链技术视频网站</a></td>

          <td><a href="https://www.ethereum.org">以太坊官网</a></td>

          <td><a href="https://solidity.readthedocs.io/en/develop/">Solidity</a></td>

          <td><a href="http://truffleframework.com/">Truffle FrameWork</a></td>

          <td><a href="http://embark.readthedocs.io">Embark FrameWork</a></td>

      </tr>
      <tr align="center" valign="middle">

          <td><a href="https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=3302cc3b-074e-44da-90b1-5055f1dc0d9c&amp;lang=zh">IBM开源技术微讲堂</a></td>

          <td><a href="https://www.bitcoin.com/">Bitcoin.com</a></td>

          <td><a href="https://github.com/bitshares/bitshares1-core">bitshares1-core</a></td>

          <td><a href="https://ipfs.io">ipfs官网</a></td>

          <td><a href="http://ipfser.org">ipfs中文网</a></td>

      </tr>
    </table>

    <div class="footer_div">
      <p class="copyright text-muted">
        Copyright &copy; 2018 刘蛟区块链博客 京ICP备15065741号. 区块链部落QQ群：348924182
      </p>
      <div align="right">
        <link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <!-- 访问统计 -->
        <span id="busuanzi_container_site_pv">
            本站总访问量
            <span id="busuanzi_value_site_pv"></span>次
        </span>

      </div>
      <div>
  </footer>
</section>

    </div>
  </div>

  <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


</body>

</html>